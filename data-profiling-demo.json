{"paragraphs":[{"title":"SET Input Data Path","text":"%spark\nval inputDataPaths = \"hdfs:///user/demo/data/wm/*\"","user":"admin","dateUpdated":"2020-02-06T15:49:05+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"inputDataPaths: String = hdfs:///user/demo/data/wm/*\n"}]},"apps":[],"jobName":"paragraph_1581004110977_757001629","id":"20200206-101528_536623074","dateCreated":"2020-02-06T15:48:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:87480","dateFinished":"2020-02-06T15:49:05+0000","dateStarted":"2020-02-06T15:49:05+0000"},{"title":"Initiallizing config & importing classes","text":"%spark\r\n// Initiallizing config & importing classes\r\n\r\nspark.conf.set(\"spark.default.parallelism\",20)\r\nspark.conf.set(\"spark.sql.shuffle.partitions\",20)\r\n\r\nimport com.amazon.deequ.profiles.{ColumnProfilerRunner, NumericColumnProfile}\r\nimport com.amazon.deequ.suggestions.{ConstraintSuggestionRunner, Rules}\r\n\r\n","user":"admin","dateUpdated":"2020-02-06T15:48:36+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.amazon.deequ.profiles.{ColumnProfilerRunner, NumericColumnProfile}\nimport com.amazon.deequ.suggestions.{ConstraintSuggestionRunner, Rules}\n"}]},"apps":[],"jobName":"paragraph_1581004110978_810185397","id":"20200109-002216_1868739462","dateCreated":"2020-02-06T15:48:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:87481","dateFinished":"2020-02-06T15:48:37+0000","dateStarted":"2020-02-06T15:48:37+0000"},{"title":"Reading Data and Calculating Number of Total & Distinct Records","text":"// Reading data \r\n\r\n\r\nval df = spark.read.format(\"csv\")\r\n  .option(\"sep\", \",\")\r\n  .option(\"inferSchema\", \"false\")\r\n  .option(\"header\", \"true\")\r\n  .load(inputDataPaths)\r\n  .filter(\"snowfall not like '%T%'\")\r\n  .withColumn(\"tmax\", when(col(\"tmax\").equalTo(\"M\"), null).otherwise(col(\"tmax\")))\r\n  .withColumn(\"tmin\", when(col(\"tmax\").equalTo(\"M\"), null).otherwise(col(\"tmax\")))\r\n  .withColumn(\"tavg\", when(col(\"tmax\").equalTo(\"M\"), null).otherwise(col(\"tmax\")))\r\n  .withColumn(\"snowfall\", when(col(\"snowfall\").equalTo(\"T\"), 0.1).otherwise(col(\"snowfall\")));\r\n\r\n\r\n\r\nprintln(\"Total Rows: \" + df.count())\r\nprintln(\"Distinct Rows: \" + df.dropDuplicates.count)\r\n\r\n","user":"admin","dateUpdated":"2020-02-06T15:48:37+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Total Rows: 20206\nDistinct Rows: 20206\ndf: org.apache.spark.sql.DataFrame = [station_nbr: string, date: string ... 18 more fields]\n"}]},"apps":[],"jobName":"paragraph_1581004110978_436035246","id":"20200108-174052_1673978492","dateCreated":"2020-02-06T15:48:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:87482","dateFinished":"2020-02-06T15:48:38+0000","dateStarted":"2020-02-06T15:48:37+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://USEAPP27767.mhf.mhc:4040/jobs/job?id=163","http://USEAPP27767.mhf.mhc:4040/jobs/job?id=164","http://USEAPP27767.mhf.mhc:4040/jobs/job?id=165"],"interpreterSettingId":"spark2"}}},{"title":"Preview Data","text":"// Preview Data\n\nz.show(df.limit(5))\n","user":"admin","dateUpdated":"2020-02-06T15:48:38+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":246,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"station_nbr":"string","date":"string","tmax":"string","tmin":"string","tavg":"string","depart":"string","dewpoint":"string","wetbulb":"string","heat":"string","cool":"string","sunrise":"string","sunset":"string","codesum":"string","snowfall":"string","preciptotal":"string","stnpressure":"string","sealevel":"string","resultspeed":"string","resultdir":"string","avgspeed":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"station_nbr","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"date","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"station_nbr\tdate\ttmax\ttmin\ttavg\tdepart\tdewpoint\twetbulb\theat\tcool\tsunrise\tsunset\tcodesum\tsnowfall\tpreciptotal\tstnpressure\tsealevel\tresultspeed\tresultdir\tavgspeed\n1\t2012-01-01\t52\t52\t52\tM\t36\t40\t23\t 0\t-\t-\tRA FZFG BR\tM\t0.05\t29.78\t29.92\t 3.6\t20\t4.6\n2\t2012-01-01\t48\t48\t48\t16\t37\t39\t24\t 0\t0716\t1626\tRA\t0.0\t0.07\t28.82\t29.91\t 9.1\t23\t11.3\n3\t2012-01-01\t55\t55\t55\t 9\t24\t36\t20\t 0\t0735\t1720\t \t0.0\t0.00\t29.77\t30.47\t 9.9\t31\t10.0\n4\t2012-01-01\t63\t63\t63\t 4\t28\t43\t10\t 0\t0728\t1742\t \t0.0\t0.00\t29.79\t30.48\t 8.0\t35\t8.2\n6\t2012-01-01\t63\t63\t63\t 0\t31\t43\t16\t 0\t0727\t1742\t \t0.0\t0.00\t29.95\t30.47\t14.0\t36\t13.8\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1581004110979_-995884438","id":"20200109-014022_1307472886","dateCreated":"2020-02-06T15:48:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:87483","dateFinished":"2020-02-06T15:48:39+0000","dateStarted":"2020-02-06T15:48:39+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://USEAPP27767.mhf.mhc:4040/jobs/job?id=166"],"interpreterSettingId":"spark2"}}},{"title":"Run Deequ Column Profiler","text":"// Run column profiler\r\n\r\nval result = ColumnProfilerRunner()\r\n  .onData(df)\r\n  .run()\r\n","user":"admin","dateUpdated":"2020-02-06T15:48:39+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":914,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"result: com.amazon.deequ.profiles.ColumnProfiles = ColumnProfiles(Map(tmax -> NumericColumnProfile(tmax,0.9552113233692963,124,Integral,true,Map(Boolean -> 0, Fractional -> 0, Integral -> 19301, Unknown -> 905, String -> 0),None,Some(72.15102844412206),Some(114.0),Some(-11.0),Some(1392587.0),Some(19.475529292818884),Some(Stream(-11.0, ?))), dewpoint -> StandardColumnProfile(dewpoint,1.0,98,String,true,Map(Boolean -> 0, Fractional -> 0, Integral -> 19543, Unknown -> 0, String -> 663),Some(Distribution(Map(45 -> DistributionValue(253,0.012521033356428783), 34 -> DistributionValue(232,0.011481738097594774), 67 -> DistributionValue(505,0.0249925764624369), -19 -> DistributionValue(2,9.898050084133426E-5), -10 -> DistributionValue(5,2.4745125210333564E-4), 12 -> DistributionValue(103,0.00509..."}]},"apps":[],"jobName":"paragraph_1581004110979_-1486645894","id":"20200108-134246_353354806","dateCreated":"2020-02-06T15:48:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:87484","dateFinished":"2020-02-06T15:48:41+0000","dateStarted":"2020-02-06T15:48:39+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://USEAPP27767.mhf.mhc:4040/jobs/job?id=167","http://USEAPP27767.mhf.mhc:4040/jobs/job?id=168","http://USEAPP27767.mhf.mhc:4040/jobs/job?id=169"],"interpreterSettingId":"spark2"}}},{"title":"Show Column Profiler Output","text":"// Print Columns Profile\n\nvar profileArray =  Seq[(String, String, Int, String, String)]()\n\nresult.profiles.foreach { case (columnName, profile) =>\n\n  val completeness = profile.completeness.toString\n  ;\n  val approximateNumDistinctValues = profile.approximateNumDistinctValues.toString\n  val dataType = profile.dataType.toString\n  var stats = \"\"\n\n    if(profile.dataType.toString.equalsIgnoreCase(\"Integral\") || profile.dataType.toString.equalsIgnoreCase(\"Fractional\")){\n      val numericProfile = result.profiles(columnName).asInstanceOf[NumericColumnProfile]\n      val minVal = numericProfile.minimum.get.toString\n      val maxVal = numericProfile.maximum.get.toString\n      val meanVal = numericProfile.mean.get.toString\n      val stdVal = numericProfile.stdDev.get.toString\n      stats = minVal+\" / \"+maxVal+\" / \"+meanVal+\" / \"+stdVal\n    }\n  profileArray :+= (s\"$columnName\",completeness, approximateNumDistinctValues.toInt, dataType, stats)\n}\n\nval profileDf = profileArray.toDF(\"Column Name\", \"Completeness\", \"Approx Distinct Values\", \"Data Type\", \"Stats (Min / Max / Mean / Std Dev)\")\nz.show(profileDf.orderBy(asc(\"Approx Distinct Values\")).limit(1000))\n    \n\n","user":"admin","dateUpdated":"2020-02-06T15:48:41+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":502,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"Column Name","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Completeness","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Approx Distinct Values","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Data Type","visible":true,"width":"*","sort":{"direction":"asc","priority":0},"filters":[{}],"pinned":""},{"name":"Stats (Min / Max / Mean / Std Dev)","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"Column Name":"string","Completeness":"string","Approx Distinct Values":"string","Data Type":"string","Stats (Min / Max / Mean / Std Dev)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Column Name\tCompleteness\tApprox Distinct Values\tData Type\tStats (Min / Max / Mean / Std Dev)\nstation_nbr\t1.0\t20\tIntegral\t1.0 / 20.0 / 10.543551420370187 / 5.747125833616759\ncool\t1.0\t38\tString\t\nresultdir\t1.0\t38\tString\t\ndepart\t1.0\t64\tString\t\nheat\t1.0\t78\tString\t\nsnowfall\t1.0\t79\tString\t\nwetbulb\t1.0\t93\tString\t\ndewpoint\t1.0\t98\tString\t\ntavg\t0.9552113233692963\t124\tIntegral\t-11.0 / 114.0 / 72.15102844412206 / 19.475529292818884\ntmin\t0.9552113233692963\t124\tIntegral\t-11.0 / 114.0 / 72.15102844412206 / 19.475529292818884\ntmax\t0.9552113233692963\t124\tIntegral\t-11.0 / 114.0 / 72.15102844412206 / 19.475529292818884\nsealevel\t1.0\t157\tString\t\nsunrise\t1.0\t226\tIntegral\t406.0 / 740.0 / 583.2591089295828 / 90.79831774323632\nsunset\t1.0\t228\tIntegral\t1611.0 / 1949.0 / 1825.806116669813 / 91.0557981088056\nresultspeed\t1.0\t264\tString\t\navgspeed\t1.0\t265\tString\t\npreciptotal\t1.0\t279\tString\t\nstnpressure\t1.0\t333\tString\t\ncodesum\t1.0\t438\tString\t\ndate\t1.0\t1017\tString\t\n"},{"type":"TEXT","data":"profileArray: Seq[(String, String, Int, String, String)] = List((tmax,0.9552113233692963,124,Integral,-11.0 / 114.0 / 72.15102844412206 / 19.475529292818884), (dewpoint,1.0,98,String,\"\"), (avgspeed,1.0,265,String,\"\"), (resultdir,1.0,38,String,\"\"), (resultspeed,1.0,264,String,\"\"), (stnpressure,1.0,333,String,\"\"), (snowfall,1.0,79,String,\"\"), (codesum,1.0,438,String,\"\"), (sealevel,1.0,157,String,\"\"), (date,1.0,1017,String,\"\"), (cool,1.0,38,String,\"\"), (sunrise,1.0,226,Integral,406.0 / 740.0 / 583.2591089295828 / 90.79831774323632), (depart,1.0,64,String,\"\"), (sunset,1.0,228,Integral,1611.0 / 1949.0 / 1825.806116669813 / 91.0557981088056), (heat,1.0,78,String,\"\"), (wetbulb,1.0,93,String,\"\"), (tavg,0.9552113233692963,124,Integral,-11.0 / 114.0 / 72.15102844412206 / 19.475529292818884), (pre..."}]},"apps":[],"jobName":"paragraph_1581004110979_-1582974064","id":"20200108-145827_1127190061","dateCreated":"2020-02-06T15:48:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:87485","dateFinished":"2020-02-06T15:48:42+0000","dateStarted":"2020-02-06T15:48:42+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://USEAPP27767.mhf.mhc:4040/jobs/job?id=170"],"interpreterSettingId":"spark2"}}},{"title":"Run Deequ Constraint Suggestion Moldule","text":"// Print Column Insights\r\n\r\nval suggestionResult = ConstraintSuggestionRunner()\r\n  .onData(df)\r\n  .addConstraintRules(Rules.DEFAULT)\r\n  .run()\r\n\r\nsuggestionResult.constraintSuggestions.foreach { case (column, suggestions) =>\r\n  suggestions.foreach { suggestion =>\r\n    println(s\"# ${suggestion.description}\" \r\n      //s\"The corresponding scala code is ${suggestion.codeForConstraint}\\n\"\r\n      )\r\n  }\r\n}\r\n\r\n","user":"admin","dateUpdated":"2020-02-06T15:48:42+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":374,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"# 'tmax' has less than 5% missing values\n# 'tmax' has type Integral\n# 'dewpoint' is not null\n# 'dewpoint' has value range 'M', '68', '69', '65', '66', '67', '63', '64', '70', '71', '72', '59', '62', '61', '60', '55', '56', '58', '54', '73', '52', '57', '51', '50', '46', '53', '48', '49', '33', '47', '29', '43', '28', '44', '40', '45', '27', '37', '39', '42', '31', '26', '38', '36', '41', '34', '25', '30', '22', '35', '32', '24', '74', '23', '21', '20', '17', '18', '19', '16', '75', '15', '12', '11', '14', '13', '10', '9', '7', '0', '8', '4', '6', '3', '2', '5', '1', '-3', '-1', '76', '-5', '-2', '-7', '-6', '-4', '-8', '-9', '-11', '-12', '-13', '-10', '-14', '-15', '77', '-19', '-17', '-24', '-16'\n# 'dewpoint' has value range 'M', '68', '69', '65', '66', '67', '63', '64', '70', '71', '72', '59', '62', '61', '60', '55', '56', '58', '54', '73', '52', '57', '51', '50', '46', '53', '48', '49', '33', '47', '29', '43', '28', '44', '40', '45', '27', '37', '39', '42', '31', '26', '38', '36', '41', '34', '25', '30', '22', '35', '32', '24', '74', '23', '21', '20' for at least 90.0% of values\n# 'avgspeed' is not null\n# 'resultdir' is not null\n# 'resultdir' has value range '17', '18', '16', '15', '19', '14', '01', '20', '36', '02', 'M', '21', '31', '35', '13', '30', '32', '22', '03', '28', '23', '33', '34', '29', '12', '05', '04', '24', '27', '25', '11', '26', '07', '06', '10', '09', '08'\n# 'resultdir' has value range '17', '18', '16', '15', '19', '14', '01', '20', '36', '02', 'M', '21', '31', '35', '13', '30', '32', '22', '03', '28', '23', '33', '34', '29', '12', '05', '04', '24', '27', '25', '11' for at least 90.0% of values\n# 'resultspeed' is not null\n# 'stnpressure' is not null\n# 'snowfall' is not null\n# 'codesum' is not null\n# 'sealevel' is not null\n# 'date' is not null\n# 'cool' is not null\n# 'cool' has value range ' 0', 'M', '18', '16', '17', '14', ' 8', ' 7', ' 4', '15', ' 6', ' 3', ' 5', '10', ' 2', ' 9', '19', ' 1', '13', '11', '12', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31', '34', '32', '33', '35'\n# 'cool' has value range ' 0', 'M', '18', '16', '17', '14', ' 8', ' 7', ' 4', '15', ' 6', ' 3', ' 5', '10', ' 2', ' 9', '19', ' 1', '13', '11' for at least 89.0% of values\n# 'sunrise' is not null\n# 'sunrise' has type Integral\n# 'sunrise' has no negative values\n# 'depart' is not null\n# 'depart' has value range 'M', ' 3', ' 4', ' 1', ' 2', ' 0', '-2', '-1', ' 5', '-3', ' 6', '-4', ' 8', ' 7', '-5', '-6', ' 9', '10', '-7' for at least 90.0% of values\n# 'sunset' is not null\n# 'sunset' has type Integral\n# 'sunset' has no negative values\n# 'heat' is not null\n# 'heat' has value range '0', 'M', '1', '2', '8', '12', '7', '10', '4', '3', '5', '11', '9', '6', '14', '20', '16', '17', '13', '15', '19', '18', '22', '23', '25', '21', '24', '27', '28', '26', '30', '31', '29', '33', '34', '32', '36', '38', '35', '37', '39', '40', '41', '43', '45', '44', '46', '47', '42', '48', '49', '53', '50', '52', '54', '51', '55', '58', '57', '60', '56', '59', '65', '61', '68', '62', '63', '69', '70', '64', '67', '75', '71', '72', '66', '81'\n# 'heat' has value range '0', 'M', '1', '2', '8', '12', '7', '10', '4', '3', '5', '11', '9', '6', '14', '20', '16', '17', '13', '15', '19', '18', '22', '23', '25', '21', '24', '27', '28', '26', '30' for at least 89.0% of values\n# 'wetbulb' is not null\n# 'wetbulb' has value range 'M', '74', '75', '73', '72', '71', '70', '67', '65', '64', '62', '68', '66', '63', '60', '61', '59', '58', '69', '56', '76', '55', '57', '52', '54', '53', '44', '45', '50', '51', '48', '49', '46', '47', '43', '41', '38', '37', '39', '40', '42', '34', '36', '35', '33', '31', '32', '77', '28', '29', '30', '27', '26', '24', '23', '25', '21', '78', '22', '20', '18', '19', '14', '17', '15', '16', '12', '10', '13', '11', '8', '79', '4', '7', '9', '0', '3', '5', '6', '-3', '2', '1', '-4', '-5', '-2', '-6', '-7', '-1', '-9', '80', '-8', '-15', '-10'\n# 'wetbulb' has value range 'M', '74', '75', '73', '72', '71', '70', '67', '65', '64', '62', '68', '66', '63', '60', '61', '59', '58', '69', '56', '76', '55', '57', '52', '54', '53', '44', '45', '50', '51', '48', '49', '46', '47', '43', '41', '38', '37', '39', '40', '42', '34', '36', '35', '33', '31', '32', '77' for at least 89.0% of values\n# 'tavg' has less than 5% missing values\n# 'tavg' has type Integral\n# 'preciptotal' is not null\n# 'station_nbr' is not null\n# 'station_nbr' has type Integral\n# 'station_nbr' has no negative values\n# 'tmin' has less than 5% missing values\n# 'tmin' has type Integral\nsuggestionResult: com.amazon.deequ.suggestions.ConstraintSuggestionResult = ConstraintSuggestionResult(Map(tmax -> NumericColumnProfile(tmax,0.9552113233692963,124,Integral,true,Map(Boolean -> 0, Fractional -> 0, Integral -> 19301, Unknown -> 905, String -> 0),None,Some(72.15102844412206),Some(114.0),Some(-11.0),Some(1392587.0),Some(19.475529292818884),Some(Stream(-11.0, ?))), dewpoint -> StandardColumnProfile(dewpoint,1.0,98,String,true,Map(Boolean -> 0, Fractional -> 0, Integral -> 19543, Unknown -> 0, String -> 663),Some(Distribution(Map(45 -> DistributionValue(253,0.012521033356428783), 34 -> DistributionValue(232,0.011481738097594774), 67 -> DistributionValue(505,0.0249925764624369), -19 -> DistributionValue(2,9.898050084133426E-5), -10 -> DistributionValue(5,2.4745125210333564E-4)..."}]},"apps":[],"jobName":"paragraph_1581004110979_-1827208001","id":"20200109-010004_540498920","dateCreated":"2020-02-06T15:48:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:87486","dateFinished":"2020-02-06T15:48:44+0000","dateStarted":"2020-02-06T15:48:42+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://USEAPP27767.mhf.mhc:4040/jobs/job?id=171","http://USEAPP27767.mhf.mhc:4040/jobs/job?id=172","http://USEAPP27767.mhf.mhc:4040/jobs/job?id=173"],"interpreterSettingId":"spark2"}}},{"title":"Show Histograms of Frequent Values in Low-Cardinality Columns","text":" \r\n// Show Histograms of Low-Cardinality Columns\r\n\r\nresult.profiles.foreach { case (columnName, profile) =>\r\n\r\n  val approximateNumDistinctValues = profile.approximateNumDistinctValues\r\n  if (!profile.histogram.isEmpty) {\r\n    println(\"Column Name: \" + columnName + \", Distinct Vals: \" + approximateNumDistinctValues)\r\n        println(s\"\"+String.format(\"%1$\"+30+ \"s\", \"Value\") +  String.format(\"%1$\"+30+ \"s\", \"Percentage\") +  String.format(\"%1$\"+30+ \"s\", \"Count\") +\"\\t\\t\"+ String.format(\"%1$-\"+30+ \"s\", \"Plot\"))\r\n    profile.histogram.foreach {\r\n      _.values.toSeq.sortBy(x=>(x._2.absolute*(-1))).foreach { case (key, entry) =>\r\n        val percentage = (entry.ratio * 100000).round/1000.toDouble\r\n        val plotString = (\"|\"*(entry.ratio*20).round.toInt)\r\n        println(s\"\"+String.format(\"%1$\"+30+ \"s\", key) +  String.format(\"%1$\"+30+ \"s\", percentage.toString) +  String.format(\"%1$\"+30+ \"s\", entry.absolute.toString) +\"\\t\\t|\"+ String.format(\"%1$-\"+30+ \"s\", plotString))\r\n      }\r\n    }\r\n    println(\"\\n\")\r\n  }\r\n}\r\n","user":"admin","dateUpdated":"2020-02-06T15:48:44+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":400,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Column Name: dewpoint, Distinct Vals: 98\n                         Value                    Percentage                         Count\t\tPlot                          \n                             M                         3.281                           663\t\t||                             \n                            68                         2.801                           566\t\t||                             \n                            69                         2.638                           533\t\t||                             \n                            65                         2.578                           521\t\t||                             \n                            66                         2.514                           508\t\t||                             \n                            67                         2.499                           505\t\t|                              \n                            63                         2.425                           490\t\t|                              \n                            64                         2.351                           475\t\t|                              \n                            70                         2.311                           467\t\t|                              \n                            71                         2.232                           451\t\t|                              \n                            72                         2.113                           427\t\t|                              \n                            62                         2.108                           426\t\t|                              \n                            59                         2.108                           426\t\t|                              \n                            61                         2.059                           416\t\t|                              \n                            60                          1.98                           400\t\t|                              \n                            56                         1.895                           383\t\t|                              \n                            55                         1.895                           383\t\t|                              \n                            58                         1.801                           364\t\t|                              \n                            54                         1.796                           363\t\t|                              \n                            73                         1.792                           362\t\t|                              \n                            52                         1.757                           355\t\t|                              \n                            57                         1.693                           342\t\t|                              \n                            51                         1.673                           338\t\t|                              \n                            50                         1.623                           328\t\t|                              \n                            46                         1.584                           320\t\t|                              \n                            53                         1.524                           308\t\t|                              \n                            48                         1.475                           298\t\t|                              \n                            49                          1.43                           289\t\t|                              \n                            33                         1.311                           265\t\t|                              \n                            47                         1.307                           264\t\t|                              \n                            29                         1.302                           263\t\t|                              \n                            43                         1.292                           261\t\t|                              \n                            28                         1.287                           260\t\t|                              \n                            44                         1.282                           259\t\t|                              \n                            40                         1.272                           257\t\t|                              \n                            45                         1.252                           253\t\t|                              \n                            27                         1.242                           251\t\t|                              \n                            37                         1.237                           250\t\t|                              \n                            39                         1.217                           246\t\t|                              \n                            31                         1.213                           245\t\t|                              \n                            42                         1.213                           245\t\t|                              \n                            26                         1.208                           244\t\t|                              \n                            38                         1.183                           239\t\t|                              \n                            36                         1.173                           237\t\t|                              \n                            41                         1.168                           236\t\t|                              \n                            34                         1.148                           232\t\t|                              \n                            25                         1.128                           228\t\t|                              \n                            30                         1.114                           225\t\t|                              \n                            22                         1.094                           221\t\t|                              \n                            35                         1.089                           220\t\t|                              \n                            32                         1.069                           216\t\t|                              \n                            24                         1.039                           210\t\t|                              \n                            74                         1.034                           209\t\t|                              \n                            23                         1.005                           203\t\t|                              \n                            21                         0.955                           193\t\t|                              \n                            20                         0.767                           155\t\t|                              \n                            17                         0.678                           137\t\t|                              \n                            18                         0.653                           132\t\t|                              \n                            19                         0.619                           125\t\t|                              \n                            16                         0.544                           110\t\t|                              \n                            75                         0.525                           106\t\t|                              \n                            15                          0.52                           105\t\t|                              \n                            12                          0.51                           103\t\t|                              \n                            11                           0.5                           101\t\t|                              \n                            14                          0.48                            97\t\t|                              \n                            13                         0.386                            78\t\t|                              \n                            10                         0.346                            70\t\t|                              \n                             9                         0.327                            66\t\t|                              \n                             7                         0.317                            64\t\t|                              \n                             0                         0.302                            61\t\t|                              \n                             8                         0.292                            59\t\t|                              \n                             4                         0.282                            57\t\t|                              \n                             6                         0.262                            53\t\t|                              \n                             3                         0.233                            47\t\t|                              \n                             5                         0.178                            36\t\t|                              \n                             2                         0.178                            36\t\t|                              \n                             1                         0.168                            34\t\t|                              \n                            -3                         0.148                            30\t\t|                              \n                            76                         0.144                            29\t\t|                              \n                            -1                         0.144                            29\t\t|                              \n                            -5                         0.134                            27\t\t|                              \n                            -2                         0.104                            21\t\t|                              \n                            -7                         0.089                            18\t\t|                              \n                            -6                         0.084                            17\t\t|                              \n                            -4                         0.059                            12\t\t|                              \n                            -8                         0.045                             9\t\t|                              \n                            -9                         0.035                             7\t\t|                              \n                           -11                          0.03                             6\t\t|                              \n                           -10                         0.025                             5\t\t|                              \n                           -13                         0.025                             5\t\t|                              \n                           -12                         0.025                             5\t\t|                              \n                           -15                          0.02                             4\t\t|                              \n                           -14                          0.02                             4\t\t|                              \n                           -19                          0.01                             2\t\t|                              \n                            77                          0.01                             2\t\t|                              \n                           -16                         0.005                             1\t\t|                              \n                           -24                         0.005                             1\t\t|                              \n                           -17                         0.005                             1\t\t|                              \n\n\nColumn Name: resultdir, Distinct Vals: 38\n                         Value                    Percentage                         Count\t\tPlot                          \n                            17                         7.369                          1489\t\t||                             \n                            18                          6.35                          1283\t\t||                             \n                            16                         5.978                          1208\t\t||                             \n                            15                         4.429                           895\t\t||                             \n                            19                         4.172                           843\t\t||                             \n                            14                         3.256                           658\t\t||                             \n                            01                         3.083                           623\t\t||                             \n                            20                         3.019                           610\t\t||                             \n                            36                         2.999                           606\t\t||                             \n                            02                         2.915                           589\t\t||                             \n                             M                          2.91                           588\t\t||                             \n                            21                         2.752                           556\t\t||                             \n                            31                         2.638                           533\t\t||                             \n                            35                         2.598                           525\t\t||                             \n                            13                         2.504                           506\t\t||                             \n                            22                          2.41                           487\t\t|                              \n                            32                          2.41                           487\t\t|                              \n                            30                          2.41                           487\t\t|                              \n                            03                         2.296                           464\t\t|                              \n                            28                         2.267                           458\t\t|                              \n                            23                         2.252                           455\t\t|                              \n                            33                         2.232                           451\t\t|                              \n                            34                         2.153                           435\t\t|                              \n                            29                         2.128                           430\t\t|                              \n                            12                         2.024                           409\t\t|                              \n                            05                         1.965                           397\t\t|                              \n                            04                         1.945                           393\t\t|                              \n                            24                          1.94                           392\t\t|                              \n                            27                          1.91                           386\t\t|                              \n                            25                         1.876                           379\t\t|                              \n                            11                         1.762                           356\t\t|                              \n                            26                         1.752                           354\t\t|                              \n                            07                         1.623                           328\t\t|                              \n                            06                         1.549                           313\t\t|                              \n                            10                          1.48                           299\t\t|                              \n                            09                         1.331                           269\t\t|                              \n                            08                         1.311                           265\t\t|                              \n\n\nColumn Name: snowfall, Distinct Vals: 79\n                         Value                    Percentage                         Count\t\tPlot                          \n                           0.0                        62.768                         12683\t\t||||||||||||||                 \n                             M                        35.752                          7224\t\t||||||||                       \n                           0.2                         0.158                            32\t\t|                              \n                           0.1                         0.153                            31\t\t|                              \n                           0.5                         0.099                            20\t\t|                              \n                           0.3                         0.089                            18\t\t|                              \n                           1.0                         0.069                            14\t\t|                              \n                           0.4                         0.064                            13\t\t|                              \n                           0.6                         0.059                            12\t\t|                              \n                           0.9                         0.054                            11\t\t|                              \n                           0.8                         0.049                            10\t\t|                              \n                           0.7                         0.045                             9\t\t|                              \n                           1.2                         0.035                             7\t\t|                              \n                           2.0                         0.035                             7\t\t|                              \n                           4.3                          0.03                             6\t\t|                              \n                           2.4                         0.025                             5\t\t|                              \n                           1.5                         0.025                             5\t\t|                              \n                           1.8                         0.025                             5\t\t|                              \n                           2.3                          0.02                             4\t\t|                              \n                           1.1                          0.02                             4\t\t|                              \n                           1.6                          0.02                             4\t\t|                              \n                           1.4                          0.02                             4\t\t|                              \n                           1.7                          0.02                             4\t\t|                              \n                           4.2                         0.015                             3\t\t|                              \n                           2.6                         0.015                             3\t\t|                              \n                           1.3                         0.015                             3\t\t|                              \n                           2.2                         0.015                             3\t\t|                              \n                           1.9                          0.01                             2\t\t|                              \n                           3.7                          0.01                             2\t\t|                              \n                           7.8                          0.01                             2\t\t|                              \n                           3.1                          0.01                             2\t\t|                              \n                           6.7                          0.01                             2\t\t|                              \n                           3.4                          0.01                             2\t\t|                              \n                           3.0                          0.01                             2\t\t|                              \n                           2.7                          0.01                             2\t\t|                              \n                          12.2                          0.01                             2\t\t|                              \n                           6.1                          0.01                             2\t\t|                              \n                           3.2                          0.01                             2\t\t|                              \n                           2.5                          0.01                             2\t\t|                              \n                           4.7                          0.01                             2\t\t|                              \n                           5.2                         0.005                             1\t\t|                              \n                           2.8                         0.005                             1\t\t|                              \n                           4.4                         0.005                             1\t\t|                              \n                           6.4                         0.005                             1\t\t|                              \n                          13.5                         0.005                             1\t\t|                              \n                           3.9                         0.005                             1\t\t|                              \n                           8.0                         0.005                             1\t\t|                              \n                           4.1                         0.005                             1\t\t|                              \n                           7.2                         0.005                             1\t\t|                              \n                           4.9                         0.005                             1\t\t|                              \n                           3.8                         0.005                             1\t\t|                              \n                           3.5                         0.005                             1\t\t|                              \n                           5.7                         0.005                             1\t\t|                              \n                           4.6                         0.005                             1\t\t|                              \n                          14.9                         0.005                             1\t\t|                              \n                          11.0                         0.005                             1\t\t|                              \n                           4.0                         0.005                             1\t\t|                              \n                           3.3                         0.005                             1\t\t|                              \n                          13.1                         0.005                             1\t\t|                              \n                           2.9                         0.005                             1\t\t|                              \n                          16.2                         0.005                             1\t\t|                              \n                           7.1                         0.005                             1\t\t|                              \n                           2.1                         0.005                             1\t\t|                              \n                           5.1                         0.005                             1\t\t|                              \n                          15.2                         0.005                             1\t\t|                              \n                           5.5                         0.005                             1\t\t|                              \n                           5.8                         0.005                             1\t\t|                              \n                           3.6                         0.005                             1\t\t|                              \n                           6.2                         0.005                             1\t\t|                              \n                           9.3                         0.005                             1\t\t|                              \n                           7.0                         0.005                             1\t\t|                              \n                           5.0                         0.005                             1\t\t|                              \n                           6.6                         0.005                             1\t\t|                              \n                          10.5                         0.005                             1\t\t|                              \n                           7.7                         0.005                             1\t\t|                              \n                           5.4                         0.005                             1\t\t|                              \n\n\nColumn Name: cool, Distinct Vals: 38\n                         Value                    Percentage                         Count\t\tPlot                          \n                             0                        47.189                          9535\t\t||||||||||                     \n                             M                         7.245                          1464\t\t||                             \n                            18                         2.321                           469\t\t|                              \n                            16                         2.123                           429\t\t|                              \n                            17                         2.084                           421\t\t|                              \n                            14                         2.069                           418\t\t|                              \n                             8                         2.039                           412\t\t|                              \n                             7                         2.034                           411\t\t|                              \n                            15                         1.999                           404\t\t|                              \n                             4                         1.999                           404\t\t|                              \n                             6                          1.99                           402\t\t|                              \n                             3                         1.985                           401\t\t|                              \n                             5                         1.975                           399\t\t|                              \n                            10                          1.97                           398\t\t|                              \n                             2                         1.945                           393\t\t|                              \n                            19                         1.925                           389\t\t|                              \n                             9                         1.925                           389\t\t|                              \n                             1                         1.876                           379\t\t|                              \n                            13                         1.826                           369\t\t|                              \n                            11                         1.792                           362\t\t|                              \n                            12                         1.777                           359\t\t|                              \n                            20                         1.683                           340\t\t|                              \n                            21                         1.475                           298\t\t|                              \n                            22                         1.252                           253\t\t|                              \n                            23                         1.064                           215\t\t|                              \n                            24                         0.807                           163\t\t|                              \n                            25                         0.614                           124\t\t|                              \n                            26                         0.361                            73\t\t|                              \n                            27                         0.252                            51\t\t|                              \n                            28                         0.153                            31\t\t|                              \n                            29                         0.129                            26\t\t|                              \n                            30                         0.045                             9\t\t|                              \n                            31                         0.025                             5\t\t|                              \n                            34                          0.02                             4\t\t|                              \n                            33                         0.015                             3\t\t|                              \n                            32                         0.015                             3\t\t|                              \n                            35                         0.005                             1\t\t|                              \n\n\nColumn Name: depart, Distinct Vals: 64\n                         Value                    Percentage                         Count\t\tPlot                          \n                             M                        56.731                         11463\t\t||||||||||||                   \n                             3                         2.737                           553\t\t||                             \n                             4                         2.603                           526\t\t||                             \n                             1                         2.534                           512\t\t||                             \n                             2                         2.499                           505\t\t|                              \n                             0                         2.455                           496\t\t|                              \n                            -2                         2.286                           462\t\t|                              \n                            -1                         2.277                           460\t\t|                              \n                             5                         2.138                           432\t\t|                              \n                             6                          1.92                           388\t\t|                              \n                            -3                          1.92                           388\t\t|                              \n                            -4                         1.623                           328\t\t|                              \n                             7                         1.603                           324\t\t|                              \n                             8                         1.603                           324\t\t|                              \n                            -5                         1.371                           277\t\t|                              \n                            -6                         1.257                           254\t\t|                              \n                             9                         1.183                           239\t\t|                              \n                            10                         1.079                           218\t\t|                              \n                            -7                          1.01                           204\t\t|                              \n                            11                         0.901                           182\t\t|                              \n                            -8                         0.777                           157\t\t|                              \n                            12                         0.688                           139\t\t|                              \n                            -9                         0.658                           133\t\t|                              \n                            13                         0.589                           119\t\t|                              \n                           -10                         0.579                           117\t\t|                              \n                            14                         0.544                           110\t\t|                              \n                           -11                         0.495                           100\t\t|                              \n                            15                         0.436                            88\t\t|                              \n                           -12                         0.411                            83\t\t|                              \n                            16                         0.371                            75\t\t|                              \n                           -13                         0.341                            69\t\t|                              \n                           -14                         0.302                            61\t\t|                              \n                           -15                         0.252                            51\t\t|                              \n                            17                         0.238                            48\t\t|                              \n                           -16                         0.208                            42\t\t|                              \n                           -17                         0.193                            39\t\t|                              \n                            18                         0.178                            36\t\t|                              \n                           -18                         0.129                            26\t\t|                              \n                            19                         0.124                            25\t\t|                              \n                            20                         0.119                            24\t\t|                              \n                            21                         0.089                            18\t\t|                              \n                            22                         0.084                            17\t\t|                              \n                           -19                         0.074                            15\t\t|                              \n                           -20                         0.059                            12\t\t|                              \n                            25                         0.045                             9\t\t|                              \n                            24                          0.04                             8\t\t|                              \n                           -21                         0.035                             7\t\t|                              \n                            28                          0.03                             6\t\t|                              \n                            23                         0.025                             5\t\t|                              \n                            26                          0.02                             4\t\t|                              \n                            27                          0.02                             4\t\t|                              \n                           -22                          0.02                             4\t\t|                              \n                           -26                         0.015                             3\t\t|                              \n                            31                         0.015                             3\t\t|                              \n                           -25                          0.01                             2\t\t|                              \n                           -24                          0.01                             2\t\t|                              \n                            29                          0.01                             2\t\t|                              \n                           -32                         0.005                             1\t\t|                              \n                           -31                         0.005                             1\t\t|                              \n                            33                         0.005                             1\t\t|                              \n                           -27                         0.005                             1\t\t|                              \n                            32                         0.005                             1\t\t|                              \n                           -28                         0.005                             1\t\t|                              \n                           -23                         0.005                             1\t\t|                              \n                            30                         0.005                             1\t\t|                              \n\n\nColumn Name: heat, Distinct Vals: 78\n                         Value                    Percentage                         Count\t\tPlot                          \n                             0                        47.328                          9563\t\t||||||||||                     \n                             M                         7.245                          1464\t\t||                             \n                             1                         1.727                           349\t\t|                              \n                             2                         1.658                           335\t\t|                              \n                             8                         1.544                           312\t\t|                              \n                            12                         1.529                           309\t\t|                              \n                             7                         1.514                           306\t\t|                              \n                            10                         1.495                           302\t\t|                              \n                             4                          1.46                           295\t\t|                              \n                             5                          1.45                           293\t\t|                              \n                             3                          1.45                           293\t\t|                              \n                            11                          1.41                           285\t\t|                              \n                             9                         1.371                           277\t\t|                              \n                             6                         1.366                           276\t\t|                              \n                            14                         1.336                           270\t\t|                              \n                            16                         1.257                           254\t\t|                              \n                            20                         1.257                           254\t\t|                              \n                            17                         1.252                           253\t\t|                              \n                            13                         1.193                           241\t\t|                              \n                            15                         1.188                           240\t\t|                              \n                            19                         1.148                           232\t\t|                              \n                            18                         1.079                           218\t\t|                              \n                            22                         1.015                           205\t\t|                              \n                            23                          0.98                           198\t\t|                              \n                            25                         0.925                           187\t\t|                              \n                            21                         0.911                           184\t\t|                              \n                            24                         0.871                           176\t\t|                              \n                            27                         0.861                           174\t\t|                              \n                            28                         0.836                           169\t\t|                              \n                            26                         0.787                           159\t\t|                              \n                            30                         0.762                           154\t\t|                              \n                            31                         0.718                           145\t\t|                              \n                            33                         0.688                           139\t\t|                              \n                            29                         0.688                           139\t\t|                              \n                            34                         0.663                           134\t\t|                              \n                            32                         0.619                           125\t\t|                              \n                            36                         0.495                           100\t\t|                              \n                            38                          0.49                            99\t\t|                              \n                            35                         0.485                            98\t\t|                              \n                            37                          0.46                            93\t\t|                              \n                            39                         0.431                            87\t\t|                              \n                            40                         0.381                            77\t\t|                              \n                            41                         0.346                            70\t\t|                              \n                            43                         0.302                            61\t\t|                              \n                            45                         0.262                            53\t\t|                              \n                            44                         0.252                            51\t\t|                              \n                            46                         0.247                            50\t\t|                              \n                            47                         0.233                            47\t\t|                              \n                            42                         0.223                            45\t\t|                              \n                            48                         0.198                            40\t\t|                              \n                            49                         0.188                            38\t\t|                              \n                            50                         0.163                            33\t\t|                              \n                            53                         0.163                            33\t\t|                              \n                            52                         0.139                            28\t\t|                              \n                            51                         0.119                            24\t\t|                              \n                            54                         0.119                            24\t\t|                              \n                            55                         0.114                            23\t\t|                              \n                            57                         0.079                            16\t\t|                              \n                            58                         0.079                            16\t\t|                              \n                            60                         0.064                            13\t\t|                              \n                            56                         0.059                            12\t\t|                              \n                            59                         0.049                            10\t\t|                              \n                            62                          0.03                             6\t\t|                              \n                            68                          0.03                             6\t\t|                              \n                            61                          0.03                             6\t\t|                              \n                            65                          0.03                             6\t\t|                              \n                            69                         0.025                             5\t\t|                              \n                            63                         0.025                             5\t\t|                              \n                            67                          0.02                             4\t\t|                              \n                            64                          0.02                             4\t\t|                              \n                            70                          0.02                             4\t\t|                              \n                            75                         0.015                             3\t\t|                              \n                            66                          0.01                             2\t\t|                              \n                            72                          0.01                             2\t\t|                              \n                            71                          0.01                             2\t\t|                              \n                            81                         0.005                             1\t\t|                              \n\n\nColumn Name: wetbulb, Distinct Vals: 93\n                         Value                    Percentage                         Count\t\tPlot                          \n                             M                         6.176                          1248\t\t||                             \n                            74                         3.845                           777\t\t||                             \n                            75                         3.385                           684\t\t||                             \n                            73                         3.281                           663\t\t||                             \n                            72                         3.014                           609\t\t||                             \n                            71                         2.603                           526\t\t||                             \n                            70                          2.38                           481\t\t|                              \n                            67                         2.336                           472\t\t|                              \n                            65                         2.272                           459\t\t|                              \n                            64                         2.158                           436\t\t|                              \n                            62                         2.143                           433\t\t|                              \n                            68                         2.113                           427\t\t|                              \n                            66                         2.098                           424\t\t|                              \n                            63                         2.084                           421\t\t|                              \n                            60                         2.069                           418\t\t|                              \n                            61                         2.024                           409\t\t|                              \n                            59                         2.019                           408\t\t|                              \n                            58                         2.004                           405\t\t|                              \n                            69                          1.97                           398\t\t|                              \n                            56                         1.895                           383\t\t|                              \n                            76                         1.792                           362\t\t|                              \n                            55                         1.752                           354\t\t|                              \n                            57                         1.702                           344\t\t|                              \n                            52                         1.658                           335\t\t|                              \n                            54                         1.633                           330\t\t|                              \n                            53                         1.603                           324\t\t|                              \n                            44                         1.599                           323\t\t|                              \n                            45                         1.519                           307\t\t|                              \n                            50                         1.509                           305\t\t|                              \n                            51                           1.5                           303\t\t|                              \n                            48                          1.46                           295\t\t|                              \n                            49                         1.455                           294\t\t|                              \n                            46                         1.425                           288\t\t|                              \n                            47                         1.341                           271\t\t|                              \n                            43                         1.336                           270\t\t|                              \n                            41                         1.307                           264\t\t|                              \n                            38                         1.302                           263\t\t|                              \n                            37                         1.287                           260\t\t|                              \n                            39                         1.232                           249\t\t|                              \n                            40                         1.227                           248\t\t|                              \n                            42                         1.203                           243\t\t|                              \n                            34                         1.153                           233\t\t|                              \n                            36                         1.143                           231\t\t|                              \n                            35                         1.133                           229\t\t|                              \n                            33                         1.029                           208\t\t|                              \n                            31                         0.975                           197\t\t|                              \n                            32                          0.96                           194\t\t|                              \n                            77                          0.93                           188\t\t|                              \n                            28                         0.866                           175\t\t|                              \n                            29                         0.836                           169\t\t|                              \n                            30                         0.817                           165\t\t|                              \n                            27                         0.737                           149\t\t|                              \n                            26                         0.653                           132\t\t|                              \n                            24                          0.51                           103\t\t|                              \n                            23                         0.495                           100\t\t|                              \n                            25                         0.485                            98\t\t|                              \n                            21                         0.401                            81\t\t|                              \n                            78                         0.396                            80\t\t|                              \n                            22                         0.351                            71\t\t|                              \n                            20                         0.317                            64\t\t|                              \n                            19                         0.292                            59\t\t|                              \n                            18                         0.292                            59\t\t|                              \n                            14                         0.287                            58\t\t|                              \n                            17                         0.243                            49\t\t|                              \n                            15                         0.233                            47\t\t|                              \n                            16                         0.223                            45\t\t|                              \n                            12                         0.188                            38\t\t|                              \n                            13                         0.168                            34\t\t|                              \n                            10                         0.168                            34\t\t|                              \n                             8                         0.139                            28\t\t|                              \n                            11                         0.139                            28\t\t|                              \n                            79                         0.104                            21\t\t|                              \n                             4                         0.089                            18\t\t|                              \n                             7                         0.074                            15\t\t|                              \n                             9                         0.069                            14\t\t|                              \n                             0                         0.064                            13\t\t|                              \n                             5                         0.049                            10\t\t|                              \n                             3                         0.049                            10\t\t|                              \n                             6                         0.045                             9\t\t|                              \n                            -3                         0.035                             7\t\t|                              \n                             2                          0.03                             6\t\t|                              \n                            -4                          0.02                             4\t\t|                              \n                             1                          0.02                             4\t\t|                              \n                            -2                         0.015                             3\t\t|                              \n                            -5                         0.015                             3\t\t|                              \n                            -7                          0.01                             2\t\t|                              \n                            -6                          0.01                             2\t\t|                              \n                           -10                         0.005                             1\t\t|                              \n                           -15                         0.005                             1\t\t|                              \n                            -8                         0.005                             1\t\t|                              \n                            80                         0.005                             1\t\t|                              \n                            -9                         0.005                             1\t\t|                              \n                            -1                         0.005                             1\t\t|                              \n\n\nColumn Name: station_nbr, Distinct Vals: 20\n                         Value                    Percentage                         Count\t\tPlot                          \n                            12                         5.122                          1035\t\t||                             \n                             8                         5.122                          1035\t\t||                             \n                             9                         5.122                          1035\t\t||                             \n                            13                         5.122                          1035\t\t||                             \n                            16                         5.122                          1035\t\t||                             \n                            10                         5.122                          1035\t\t||                             \n                             1                         5.122                          1035\t\t||                             \n                            20                         5.122                          1035\t\t||                             \n                            11                         5.117                          1034\t\t||                             \n                            17                         5.117                          1034\t\t||                             \n                             4                         5.083                          1027\t\t||                             \n                            18                         5.073                          1025\t\t||                             \n                             6                         5.053                          1021\t\t||                             \n                             7                         5.043                          1019\t\t||                             \n                            14                         4.979                          1006\t\t||                             \n                             3                         4.959                          1002\t\t||                             \n                            15                         4.865                           983\t\t||                             \n                             2                         4.796                           969\t\t||                             \n                            19                         4.721                           954\t\t||                             \n                             5                         4.217                           852\t\t||                             \n\n\n"}]},"apps":[],"jobName":"paragraph_1581004110980_-1791887090","id":"20200115-162941_1329337274","dateCreated":"2020-02-06T15:48:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:87487","dateFinished":"2020-02-06T15:48:45+0000","dateStarted":"2020-02-06T15:48:45+0000"},{"title":"Auto-generate Spark Code for Proposed Schema","text":"    // Proposed Schema\r\n\r\n    var proposedSchemaText = \"val proposedSchema = new StructType(Array( \\n\"\r\n\r\n    df.schema.foreach { originalColScehma =>\r\n      val columnName = originalColScehma.name\r\n      val profile = result.profiles(columnName)\r\n      val completeness = profile.completeness;\r\n      val dataType = profile.dataType.toString\r\n      val isNullable = (completeness<1.0);\r\n\r\n      if(dataType.equalsIgnoreCase(\"Integral\")){\r\n        proposedSchemaText += \"\\tStructField(\\\"\" +columnName +\"\\\", IntegerType, \"+isNullable+\"), \\n\"\r\n      }else if(dataType.equalsIgnoreCase(\"Fractional\")){\r\n        proposedSchemaText += \"\\tStructField(\\\"\" +columnName +\"\\\", DoubleType, \"+isNullable+\"), \\n\"\r\n      }else{\r\n        proposedSchemaText += \"\\tStructField(\\\"\" +columnName +\"\\\", StringType, \"+isNullable+\"), \\n\"\r\n      }\r\n    }\r\n\r\n    proposedSchemaText =proposedSchemaText.dropRight(3)+\"\\n))\"\r\n    println(proposedSchemaText+\"\\n\")\r\n\r\n","user":"admin","dateUpdated":"2020-02-06T15:48:45+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":412,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"val proposedSchema = new StructType(Array( \n\tStructField(\"station_nbr\", IntegerType, false), \n\tStructField(\"date\", StringType, false), \n\tStructField(\"tmax\", IntegerType, true), \n\tStructField(\"tmin\", IntegerType, true), \n\tStructField(\"tavg\", IntegerType, true), \n\tStructField(\"depart\", StringType, false), \n\tStructField(\"dewpoint\", StringType, false), \n\tStructField(\"wetbulb\", StringType, false), \n\tStructField(\"heat\", StringType, false), \n\tStructField(\"cool\", StringType, false), \n\tStructField(\"sunrise\", IntegerType, false), \n\tStructField(\"sunset\", IntegerType, false), \n\tStructField(\"codesum\", StringType, false), \n\tStructField(\"snowfall\", StringType, false), \n\tStructField(\"preciptotal\", StringType, false), \n\tStructField(\"stnpressure\", StringType, false), \n\tStructField(\"sealevel\", StringType, false), \n\tStructField(\"resultspeed\", StringType, false), \n\tStructField(\"resultdir\", StringType, false), \n\tStructField(\"avgspeed\", StringType, false)\n))\n\nproposedSchemaText: String =\nval proposedSchema = new StructType(Array(\n\tStructField(\"station_nbr\", IntegerType, false),\n\tStructField(\"date\", StringType, false),\n\tStructField(\"tmax\", IntegerType, true),\n\tStructField(\"tmin\", IntegerType, true),\n\tStructField(\"tavg\", IntegerType, true),\n\tStructField(\"depart\", StringType, false),\n\tStructField(\"dewpoint\", StringType, false),\n\tStructField(\"wetbulb\", StringType, false),\n\tStructField(\"heat\", StringType, false),\n\tStructField(\"cool\", StringType, false),\n\tStructField(\"sunrise\", IntegerType, false),\n\tStructField(\"sunset\", IntegerType, false),\n\tStructField(\"codesum\", StringType, false),\n\tStructField(\"snowfall\", StringType, false),\n\tStructField(\"preciptotal\", StringType, false),\n\tStructField(\"stnpressure\", StringType, false),\n\tStructField(\"sealevel\",..."}]},"apps":[],"jobName":"paragraph_1581004110981_1407153896","id":"20200116-150300_1865756867","dateCreated":"2020-02-06T15:48:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:87488","dateFinished":"2020-02-06T15:48:46+0000","dateStarted":"2020-02-06T15:48:46+0000"},{"user":"admin","dateUpdated":"2020-02-06T15:48:30+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1581004110981_-1178185147","id":"20200206-120207_188304206","dateCreated":"2020-02-06T15:48:30+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:87490"}],"name":"data-profiling-demo","id":"2F31XE5HU","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}